# ============================================
# OAuth2 Configuration - Two Client Setup
# ============================================
# IMPORTANT: This setup uses TWO separate OAuth clients for better security:
# 1. PUBLIC CLIENT - Used by frontend app (no secret, uses PKCE)
# 2. CONFIDENTIAL CLIENT - Used by Trino server (has secret for token validation)

# Provider Selection (google, github, auth0, keycloak, generic)
VITE_OAUTH_PROVIDER=google

# PUBLIC CLIENT - Frontend Application (React)
# This client is used by the frontend to authenticate users
# - Public client (no secret needed)
# - Uses PKCE for security
# - Configure in OAuth provider as "Web Application" or "SPA"
OAUTH2_PUBLIC_CLIENT_ID=your-public-client-id

# CONFIDENTIAL CLIENT - Trino Server
# This client is used by Trino to validate OAuth tokens
# - Confidential client (requires secret)
# - Used for JWT validation via JWKS
# - Configure in OAuth provider as "Web Application" with client secret
OAUTH2_TRINO_CLIENT_ID=your-trino-client-id
OAUTH2_TRINO_CLIENT_SECRET=your-trino-client-secret

# OAuth2 Endpoints (used by Trino and Backend)
OAUTH2_ISSUER_URL=https://accounts.google.com
OAUTH2_JWKS_URL=https://www.googleapis.com/oauth2/v3/certs
OAUTH2_AUTHORIZATION_URL=https://accounts.google.com/o/oauth2/v2/auth
OAUTH2_TOKEN_URL=https://oauth2.googleapis.com/token
OAUTH2_USERINFO_URL=https://www.googleapis.com/oauth2/v3/userinfo

# OAuth2 Settings
OAUTH2_SCOPES=openid email profile
OAUTH2_REDIRECT_URI=http://localhost:5173/callback
OAUTH2_PRINCIPAL_FIELD=email

# ============================================
# Frontend Configuration (Vite requires VITE_ prefix)
# ============================================
VITE_BACKEND_URL=http://localhost:3001

# Google OAuth2 (when VITE_OAUTH_PROVIDER=google)
# Use the PUBLIC client ID here
VITE_GOOGLE_CLIENT_ID=your-public-client-id
VITE_GOOGLE_REDIRECT_URI=http://localhost:5173/callback

# GitHub OAuth2 (when VITE_OAUTH_PROVIDER=github)
# Use the PUBLIC client ID here
# Note: GitHub requires a client secret even for public clients with PKCE
VITE_GITHUB_CLIENT_ID=your-public-client-id
VITE_GITHUB_REDIRECT_URI=http://localhost:5173/callback
OAUTH2_PUBLIC_CLIENT_SECRET=your-github-client-secret-if-needed

# Auth0 Configuration (when VITE_OAUTH_PROVIDER=auth0)
# Use the PUBLIC client ID here
VITE_AUTH0_DOMAIN=your-domain.auth0.com
VITE_AUTH0_CLIENT_ID=your-public-client-id
VITE_AUTH0_REDIRECT_URI=http://localhost:5173/callback

# Keycloak Configuration (when VITE_OAUTH_PROVIDER=keycloak)
# Use the PUBLIC client ID here
VITE_KEYCLOAK_URL=http://localhost:8081
VITE_KEYCLOAK_REALM=trino-master-realm
VITE_KEYCLOAK_CLIENT_ID=react-app-public

# Generic OAuth2 Configuration (when VITE_OAUTH_PROVIDER=generic)
# Use the PUBLIC client ID here
VITE_OAUTH_AUTHORIZATION_URL=https://your-idp.com/oauth/authorize
VITE_OAUTH_TOKEN_URL=https://your-idp.com/oauth/token
VITE_OAUTH_USERINFO_URL=https://your-idp.com/oauth/userinfo
VITE_OAUTH_CLIENT_ID=your-client-id
VITE_OAUTH_REDIRECT_URI=http://localhost:5173/callback
VITE_OAUTH_SCOPE=openid profile email

# ============================================
# Access Control Configuration
# ============================================
# Admin user who has full access to Trino
# Must match the email/username from your OAuth provider token
TRINO_ADMIN_USERNAME=your-email@gmail.com

# ============================================
# Trino Configuration
# ============================================
TRINO_HOST=trino
TRINO_PORT=8080
TRINO_CATALOG=tpch
TRINO_SCHEMA=sf1

# Internal Communication Secret (change in production!)
# Must be at least 256 bits (32 characters)
TRINO_INTERNAL_SECRET=change-this-to-random-string-min-256-bits

# ============================================
# Backend Configuration
# ============================================
FRONTEND_ORIGIN=http://localhost:5173

# ============================================
# Provider-Specific Setup Instructions
# ============================================

# --- Google OAuth2 Two-Client Setup ---
# 
# Public Client (Frontend):
# 1. Go to: https://console.cloud.google.com/apis/credentials
# 2. Create OAuth 2.0 Client ID → Web Application
# 3. Name: "Trino OAuth Demo - Frontend"
# 4. Add authorized redirect URI: http://localhost:5173/callback
# 5. Copy Client ID → OAUTH2_PUBLIC_CLIENT_ID and VITE_GOOGLE_CLIENT_ID
#
# Confidential Client (Trino):
# 1. Create another OAuth 2.0 Client ID → Web Application  
# 2. Name: "Trino OAuth Demo - Trino Server"
# 3. Add redirect URIs: 
#    - http://localhost:8080/oauth2/callback
#    - http://localhost:8080/ui/oauth2/callback
# 4. Copy Client ID → OAUTH2_TRINO_CLIENT_ID
# 5. Copy Client Secret → OAUTH2_TRINO_CLIENT_SECRET
#
# Set these variables:
#    OAUTH2_PUBLIC_CLIENT_ID=public-xxx.apps.googleusercontent.com
#    OAUTH2_TRINO_CLIENT_ID=trino-xxx.apps.googleusercontent.com
#    OAUTH2_TRINO_CLIENT_SECRET=GOCSPX-xxxxxxxxxxxxx
#    VITE_GOOGLE_CLIENT_ID=public-xxx.apps.googleusercontent.com
#    OAUTH2_ISSUER_URL=https://accounts.google.com
#    OAUTH2_JWKS_URL=https://www.googleapis.com/oauth2/v3/certs

# --- GitHub OAuth2 Two-Client Setup ---
# Note: GitHub requires client secrets even for public clients
# 
# Public Client (Frontend):
# 1. Go to: https://github.com/settings/developers
# 2. Create New OAuth App
# 3. Name: "Trino OAuth Demo - Frontend"
# 4. Authorization callback URL: http://localhost:5173/callback
# 5. Copy Client ID and Secret
#
# Confidential Client (Trino):
# 1. Create another OAuth App
# 2. Name: "Trino OAuth Demo - Trino"
# 3. Authorization callback URL: http://localhost:8080/oauth2/callback
# 4. Copy Client ID and Secret
#
# Set these variables:
#    VITE_OAUTH_PROVIDER=github
#    OAUTH2_PUBLIC_CLIENT_ID=your-public-github-client-id
#    OAUTH2_PUBLIC_CLIENT_SECRET=your-public-github-client-secret
#    OAUTH2_TRINO_CLIENT_ID=your-trino-github-client-id
#    OAUTH2_TRINO_CLIENT_SECRET=your-trino-github-client-secret
#    VITE_GITHUB_CLIENT_ID=your-github-client-id
#    OAUTH2_ISSUER_URL=https://github.com
#    OAUTH2_JWKS_URL=https://token.actions.githubusercontent.com/.well-known/jwks

# --- Auth0 ---
# 1. Go to: https://manage.auth0.com/
# 2. Create Application (Single Page Application)
# 3. Add Allowed Callback URL: http://localhost:5173/callback
# 4. Copy Domain and Client ID and set:
#    VITE_OAUTH_PROVIDER=auth0
#    VITE_AUTH0_DOMAIN=your-domain.auth0.com
#    VITE_AUTH0_CLIENT_ID=your-auth0-client-id
#    OAUTH2_CLIENT_ID=your-auth0-client-id
#    OAUTH2_CLIENT_SECRET=your-auth0-client-secret
#    OAUTH2_ISSUER_URL=https://your-domain.auth0.com/
#    OAUTH2_JWKS_URL=https://your-domain.auth0.com/.well-known/jwks.json
